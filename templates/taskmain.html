<!--íˆ¬ë‘ë¦¬ìŠ¤íŠ¸ ë³¸ í˜ì´ì§€: ë‹¬ë ¥ ìˆê³ , í•  ì¼ ëœ¨ëŠ” í˜ì´ì§€-->
<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>íˆ¬ë‘ë¦¬ìŠ¤íŠ¸</title>
  <script src="https://cdn.tailwindcss.com/3.4.16"></script>
  <script>tailwind.config = { theme: { extend: { colors: { primary: '#4ade80', secondary: '#a3e635' }, borderRadius: { 'none': '0px', 'sm': '4px', DEFAULT: '8px', 'md': '12px', 'lg': '16px', 'xl': '20px', '2xl': '24px', '3xl': '32px', 'full': '9999px', 'button': '8px' } } } }</script>
  <!--ë””ìì¸ì„ ìœ„í•œ ì½”ë“œ: ì‚­ì œí•˜ë©´ ì•ˆë¨-->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <!--ì•„ì´ì½˜-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">
</head>

<body class="h-full w-full min-h-screen min-w-full">
  <div class="flex min-h-screen h-full w-full">
    <div class="w-64 border-r border-gray-200 bg-white flex-shrink-0 flex flex-col">
      <div class="p-4 border-b border-gray-200 flex items-center">
        <div class="font-['Pacifico'] text-primary text-xl">logo</div>
        <div class="w-8 h-8 flex items-center justify-center ml-auto">
          <i class="ri-menu-line text-gray-500"></i>
        </div>
      </div>

      <!-- âœ… id="categoryItems" ì¶”ê°€: ì¶”ê°€ëœ ì¹´í…Œê³ ë¦¬ ì‚½ì… ìœ„ì¹˜ ì§€ì • (class ë³€ê²½) -->
      <div id="categoryItems" class="p-4 flex-1 overflow-y-auto">
        <h2 class="text-sm font-medium text-gray-500 mb-2">ì¹´í…Œê³ ë¦¬</h2>
        <!-- âœ… ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ë²„íŠ¼ id (id ì¶”ê°€í•¨)-->
        <div class="space-y-1" id="categoryListContainer">

          <!--íŒ€í”Œ ì¹´í…Œê³ ë¦¬(ê¸°ë³¸ìœ¼ë¡œ 1ê°œë§Œ)-->
          <div class="category-item flex items-center px-3 py-2 rounded bg-green-50 hover:bg-gray-50 group">
            <div class="w-6 h-6 flex items-center justify-center mr-2 text-green-500">
              <i class="ri-heart-line"></i>
            </div>
            <!-- âœ… ê¸°ë³¸ ì¹´í…Œê³ ë¦¬ ì´ë¦„ì€ ìˆ˜ì • ê°€ëŠ¥í•˜ë„ë¡ spanì— "contenteditable false" -->
            <span contenteditable="false" class="category-name text-green-600 font-medium">íŒ€í”Œ</span>
            <div
              class="category-actions opacity-0 group-hover:opacity-100 flex ml-auto transition-opacity duration-200">
              <!-- âœ… ì—°í•„ ì•„ì´ì½˜ ("edit-btn" ì¶”ê°€) -->
              <button class="edit-button w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600">
                <i class="ri-edit-line"></i>
              </button>
              <!--âœ… ì‚­ì œ ì•„ì´ì½˜ ë²„íŠ¼ ("delete-btn" ì¶”ê°€)-->
              <button class="delete-button w-6 h-6 flex items-center justify-center text-gray-400 hover:text-red-500">
                <i class="ri-delete-bin-line"></i>
              </button>
            </div>
          </div>
          <!--âœ… ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ë²„íŠ¼(ê³ ì •ë²„íŠ¼ì„)-->
          <button id="addCategoryBtn"
            class="mt-4 w-full flex items-center justify-center gap-2 text-sm text-white bg-primary hover:bg-green-500 py-2 px-4 rounded-button shadow transition-all duration-200">
            <i class="ri-add-line text-lg"></i>
            <span>ì¹´í…Œê³ ë¦¬ ì¶”ê°€</span>
          </button>
        </div>
      </div>
    </div>

    <!--ë©”ì¸ì½˜í…ì¸ -->
    <div class="flex-1 flex flex-col min-h-0 h-full p-6">
      <div class="border-b border-gray-200 pb-4 mb-6">
        <h1 class="text-xl font-semibold">íˆ¬ë‘ë¦¬ìŠ¤íŠ¸</h1>
      </div>
      <div class="flex items-center mb-6">
        <!--**ì˜¤ëŠ˜ì˜ ë‚ ì§œ + ë‚¨ì€ í•  ì¼ ëª©ë¡**-->
        <h2 class="text-lg font-medium text-gray-900" id="top-today-todo-date">ì˜¤ëŠ˜ì˜ todo</h2>
        <!-- <span class="ml-2 text-sm text-gray-500" id="today-listnum">13ê°œì˜ í•­ëª©</span> -->
      </div>

      <!--ì´ ì½”ë“œê°€ ìº˜ë¦°ë”ë‘ ì¼ì¼ íˆ¬ë‘ ë‚˜ë€íˆ ë„ì›Œì£¼ê³  ìˆìœ¼ë‹ˆ ì‚­ì œí•˜ë©´ ì•ˆë¼ìš”!-->
      <div class="flex-1 min-h-0 flex flex-col">
        <div class="grid grid-cols-2 gap-6 h-full min-h-0 flex-1">
          <!-- ìº˜ë¦°ë” -->
          <div class="h-full flex flex-col min-h-0">
            <div class="bg-white border border-gray-200 rounded-lg p-5 shadow-sm flex-1 flex flex-col min-h-0">
              <!--ìº˜ë¦°ë” ìƒë‹¨ë¶€ë¶„-->
              <div class="flex justify-between items-center mb-4">
                <h3 class="font-medium" id="calendertop-date">5ì›” 2025</h3>
                <div class="flex">
                  <button
                    class="w-8 h-8 flex items-center justify-center text-gray-500 hover:text-gray-900 !rounded-button"
                    id="lastmonth-button">
                    <i class="ri-arrow-left-s-line"></i>
                  </button>
                  <button
                    class="w-8 h-8 flex items-center justify-center text-gray-500 hover:text-gray-900 !rounded-button"
                    id="nextmonth-button">
                    <i class="ri-arrow-right-s-line"></i>
                  </button>
                </div>
              </div>

              <div class="grid grid-cols-7 gap-1 mb-2">
                <div class="text-center text-sm font-medium text-gray-600">SUN</div>
                <div class="text-center text-sm font-medium text-gray-600">MON</div>
                <div class="text-center text-sm font-medium text-gray-600">TUE</div>
                <div class="text-center text-sm font-medium text-gray-600">WED</div>
                <div class="text-center text-sm font-medium text-gray-600">THU</div>
                <div class="text-center text-sm font-medium text-gray-600">FRI</div>
                <div class="text-center text-sm font-medium text-gray-600">SAT</div>
              </div>

              <!--ìº˜ë¦°ë”: ê·¸ë¦¬ë“œ ì»¨í…Œì´ë„ˆë¡œ ì—´7ê°œ, gapì€1ì”© ì£¼ê²Œë˜ì–´ìˆëŠ” ë””ìì¸ì…ë‹ˆë‹¤. 7ì€ ê±´ë“¤ì§€ ë§ê³ , ê°„ê²© ë„ìš°ê³  ì‹¶ìœ¼ë©´ 1ë§Œ ì›€ì§ì´ì„¸ìš”-->
              <div class="grid grid-cols-7 gap-1 flex-1 min-h-0" id="ë‹¬ë ¥"></div>
            </div>
          </div>

          <div class="h-full flex flex-col min-h-0">
            <!-- ì¼ì¼ íˆ¬ë‘ -->
            <div class="bg-white border border-gray-200 rounded-lg p-5 shadow-sm flex-1 flex flex-col min-h-0">

              <div class="flex justify-between items-center mb-4">
                <h3 class="font-medium" id="today-todo-date"></h3>
                <!--ğŸ”´ íˆ¬ë°ì´ í•  ì¼ í•­ëª© ê°œìˆ˜: ì´ê±° ì•„ë§ˆ ë™ì ìœ¼ë¡œ ë°”ê¿”ì•¼í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤. ë¬´ë¦¬ë©´ ê·¸ëƒ¥ ë¹¼ê³ ìš”-->
                <!-- <span class="text-xs text-gray-500">10ê°œì˜ í•­ëª©</span> -->
              </div>

              <!--íˆ¬ë‘ë¦¬ìŠ¤íŠ¸ ë™ì ìœ¼ë¡œ êµ¬í˜„í•˜ëŠ” ê²ƒ í•„ìš” + DB/íŒŒì¼ ë“±ë“±..ì¨‹ë“  ì •ë³´ ì €ì¥í•˜ëŠ” ë°©ë²• êµ¬í˜„ í•„ìš”-->
              <!-- ë§ˆìŒ ì¹´í…Œê³ ë¦¬ -->
              <div class="mb-5" id="todoarea">
                <div class="todolist-card" id="todo-card"></div>
              </div>
              <button class="text-sm text-gray-500 hover:text-primary flex items-center" id="addtodo">
                <div class="w-4 h-4 flex items-center justify-center mr-1">
                  <i class="ri-add-line"></i>
                </div>
                ì¶”ê°€í•˜ê¸°
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const today = new Date();
    //ë‚ ì§œ ë³´ì´ëŠ” ë³€ìˆ˜ë“¤
    let defaultmonth = today.getMonth() + 1;
    let defaultyear = today.getFullYear();
    let selectedMonth = defaultmonth;
    let selectedDay = today.getDate();

    //html ë¡œë“œ í›„ ì§„í–‰ë˜ëŠ” ë¶€ë¶„
    document.addEventListener('DOMContentLoaded', function () {
      renderCalender(defaultyear, defaultmonth);
      loadtodolist(selectedMonth, selectedDay);

      //ì‚¬ì´ë“œë°”: ì¹´í…Œê³ ë¦¬ ë¶€ë¶„
      const categoryItems = document.querySelectorAll('.sidebar .flex.items-center.px-3.py-2');
      categoryItems.forEach(item => {
        item.addEventListener('click', function () {
          // í˜„ì¬ ì„ íƒëœ ì¹´í…Œê³ ë¦¬ í´ë˜ìŠ¤ ì œê±°
          document.querySelector('.sidebar .flex.items-center.px-3.py-2.bg-green-50')?.classList.remove('bg-green-50');
          // ìƒˆë¡œ ì„ íƒí•œ ì¹´í…Œê³ ë¦¬ì— í´ë˜ìŠ¤ ì¶”ê°€
          this.classList.add('bg-green-50');
        });
      });

      //ì¹´í…Œê³ ë¦¬ í…ŒìŠ¤íŠ¸ìš©
    // ì¹´í…Œê³ ë¦¬ ì„ íƒ ê¸°ëŠ¥
    // âœ… ì¹´í…Œê³ ë¦¬ ë™ì‘ ë°”ì¸ë”© í•¨ìˆ˜
    function activateCategoryItemEvents(item) {
      const textElement = item.querySelector('.category-name');   //í´ë¦­
      const editBtn = item.querySelector('.edit-button');
      const deleteBtn = item.querySelector('.delete-button');       //ì‚­ì œ

      // ì„ íƒ ì‹œ ê°•ì¡° í‘œì‹œ
      item.addEventListener('click', () => {
        document.querySelectorAll('.category-item').forEach(i => i.classList.remove('bg-green-50'));
        item.classList.add('bg-green-50');
      });


      // âœ… ì—°í•„ ì•„ì´ì½˜ í´ë¦­ ì‹œ contenteditable ì ìš©(ì—°í•„ ì•„ì´ì½˜ í´ë¦­ ì‹œ í…ìŠ¤íŠ¸ ìˆ˜ì • ê°€ëŠ¥)
      editBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        textElement.setAttribute('contenteditable', 'true');
        textElement.focus();

        textElement.addEventListener('blur', () => {
          textElement.setAttribute('contenteditable', 'false');
        }, { once: true });
      });

      // âœ… íœ´ì§€í†µ ì•„ì´ì½˜ í´ë¦­ ì‹œ
      deleteBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        item.remove();
      });
    }

    // âœ… ì´ˆê¸° ì¹´í…Œê³ ë¦¬ì— ì´ë²¤íŠ¸ ë°”ì¸ë”©ìˆ˜ì •/ì‚­ì œ/ì„ íƒì„ ë¯¸ë¦¬)
    activateCategoryItemEvents(document.querySelector('.category-item'));

    // âœ… ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ê¸°ëŠ¥(ì¶”ê°€ ë²„íŠ¼ í´ë¦­ ì‹œ ìƒˆë¡œìš´ ì¹´í…Œê³ ë¦¬ DOM ìƒì„±)
    document.getElementById('addCategoryBtn').addEventListener('click', () => {
      const newItem = document.createElement('div');
      newItem.className = 'category-item flex items-center px-3 py-2 rounded hover:bg-gray-50 group';
      newItem.innerHTML = `
                    <div class="w-6 h-6 flex items-center justify-center mr-2 text-blue-500">
                        <i class="ri-heart-line"></i>
                    </div>

                    <span class="category-name text-blue-600 font-medium" contenteditable="false">ìƒˆ ì¹´í…Œê³ ë¦¬</span>

                 <div class="category-actions opacity-0 group-hover:opacity-100 flex ml-auto transition-opacity duration-200">
                        <button class="edit-button w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600">
                            <i class="ri-edit-line"></i>
                        </button>
                        <button class="delete-button w-6 h-6 flex items-center justify-center text-gray-400 hover:text-red-500">
                            <i class="ri-delete-bin-line"></i>
                        </button>
                    </div>`;

      const container = document.getElementById('categoryListContainer');
      const addButton = document.getElementById('addCategoryBtn');
      container.insertBefore(newItem, addButton); // âœ… ì¶”ê°€ ë²„íŠ¼ ë°”ë¡œ ìœ„ì— ì‚½ì…
      activateCategoryItemEvents(newItem);
    });

    ///


    });

    // < ë²„íŠ¼ê³¼ ì—°ê²°: í´ë¦­ ì‹œ ë°œìƒí•˜ëŠ” ì´ë²¤íŠ¸
    document.getElementById('lastmonth-button').addEventListener('click', function () {
      defaultmonth--;
      if (defaultmonth < 1) {
        defaultmonth = 12;
        defaultyear--;
      }
      //ë‹¬ë ¥ ë Œë”ë§ í•¨ìˆ˜ í˜¸ì¶œí•˜ë©´ì„œ ì—°, ì›” ì¸ìë¡œ ì „ë‹¬
      renderCalender(defaultyear, defaultmonth);
    });

    // > ë²„íŠ¼ê³¼ ì—°ê²°: í´ë¦­ ì‹œ ë°œìƒí•˜ëŠ” ì´ë²¤íŠ¸
    document.getElementById('nextmonth-button').addEventListener('click', function () {
      defaultmonth++;
      if (defaultmonth > 12) {
        defaultmonth = 1;
        defaultyear++;
      }
      //ì—¬ê¸°ë„ ë‹¬ë ¥ ë Œë”ë§ ë§ˆì§€ë§‰ì—í•˜ë©´ì„œ ì—°, ì›” ì¸ìë¡œ ì „ë‹¬
      renderCalender(defaultyear, defaultmonth);
    });

    //ë‹¬ë ¥ ë Œë”ë§ í•¨ìˆ˜: (ì—°, ì›”) ì¸ìë¡œ ë°›ì•„ì„œ ì²˜ë¦¬
    function renderCalender(year, month) {
      //htmlì—ì„œ id ë‹¬ë ¥ìœ¼ë¡œ ì„¤ì •í•´ë‘”ê±° ë¶ˆëŸ¬ì™€ì„œ calenderselection ë³€ìˆ˜ì— ì €ì¥ ë° ì´ˆê¸°í™”
      const calendersection = document.getElementById('ë‹¬ë ¥');
      calendersection.innerHTML = '';
      //ìº˜ë¦°ë” ìƒë‹¨ ë‚ ì§œ í¸ì§‘
      const editCalenderTop = document.getElementById('calendertop-date');
      editCalenderTop.textContent = `${month}ì›” ${year}`;

      const firstDay = new Date(year, month - 1, 1);
      const lastDay = new Date(year, month, 0);
      const firstWeekDay = firstDay.getDay();
      const lastMonthLastDay = new Date(year, month - 1, 0).getDate();

      for (let i = firstWeekDay - 1; i >= 0; i--) {
        const dayDiv = document.createElement('div');
        dayDiv.className = "flex justify-center";
        dayDiv.innerHTML = `<div class="day text-gray-400">${lastMonthLastDay - i}</div>`;
        calendersection.appendChild(dayDiv);
      }

      for (let d = 1; d <= lastDay.getDate(); d++) {
        const dayDiv = document.createElement('div');
        dayDiv.className = "flex justify-center";
        dayDiv.innerHTML = `<div class="day bg-white">${d}</div>`;
        calendersection.appendChild(dayDiv);
      }

      //ë‹¬ë ¥ì—ì„œ í´ë¦­ ì´ë²¤íŠ¸ ë°œìƒì‹œ:
      document.getElementById('ë‹¬ë ¥').addEventListener('click', function (e) {
        //ë‚ ì§œ í´ë¦­ ì‹œ ë°œìƒí•˜ëŠ” ì´ë²¤íŠ¸: ë‚ ì§œë“¤ì— day í´ë˜ìŠ¤ ì§€ì •
        if (e.target.classList.contains('day')) {
          document.querySelector('.day.active')?.classList.remove('active', 'bg-primary', 'text-white');
          e.target.classList.add('active', 'bg-primary', 'text-white');

          selectedMonth = defaultmonth;
          selectedDay = parseInt(e.target.textContent);

          //í´ë¦­í•œ ë‚ ì§œì— ë§ê²Œ ë‚ ì§œ ë°”ê¾¸ë„ë¡ ì§€ì •
          document.getElementById('today-todo-date').textContent = `${selectedMonth}/${selectedDay}`;
          document.getElementById('top-today-todo-date').textContent = `${selectedMonth}/${selectedDay} ì˜¤ëŠ˜ì˜ todo`;

          loadtodolist(selectedMonth, selectedDay);
        }
      });
    }

    //íˆ¬ë‘ë¦¬ìŠ¤íŠ¸ ë™ì  ë¡œë“œ ë©”ì†Œë“œ: í´ë¦­í•œ ë‚ ì§œì˜ 'ì›”, ì¼' ì¸ìë¡œ ë°›ì•„ì™€ì„œ ì‹¤í–‰
    async function loadtodolist(month, day) {
      //'/api/todolist' ë¼ìš°íŒ…. ë°±ì—”ë“œì—ì„œ json í˜•íƒœë¡œ DB ë‚´ìš© ë°›ì•„ì˜´
      const res = await fetch(`api/todolist?month=${month}&day=${day}`);
      const todos = await res.json();

      //ì˜¤ë¥¸ìª½ í•  ì¼ ëª©ë¡ ì¶œë ¥ë˜ëŠ” ë¶€ë¶„ ë³€ìˆ˜ì— ì§€ì • ë° ì´ˆê¸°í™”
      const todoArea = document.getElementById("todoarea");
      todoArea.innerHTML = '';

      //í•´ë‹¹ div ì•„ë˜ì— ì¶”ê°€í•  ìš”ì†Œë“¤ ìƒì„±
      const Area = document.createElement('div');
      Area.className = "mb-2";

      const ul = document.createElement('ul');
      ul.className = "space-y-2";

      //ë°˜ë³µë¬¸ í†µí•´ DBì— ìˆëŠ” í•  ì¼ ëª©ë¡ì— ë§ëŠ” í•  ì¼ ëª©ë¡(í•˜ë‚˜í•˜ë‚˜) ìƒì„±: í•  ì¼ ëª©ë¡ id, ë‚´ìš©, ìƒíƒœ(ì™„ë£Œ-true/ë¯¸ì™„ë£Œ-false)
      todos.forEach(item => {
        const li = createTodoElement(item.id, item.todo, item.state);
        ul.appendChild(li);
      });

      //ìƒˆë¡œ ìƒì„±í•œ ìš”ì†Œ ìœ„ì—ì„œ ì •ì˜í•œ í•  ì¼ ëª©ë¡ ì§€ì—­ ì•„ë˜ì— ë¶™ì´ê¸°
      Area.appendChild(ul);
      todoArea.appendChild(Area);
    }

    //í•  ì¼ ëª©ë¡ ìš”ì†Œ ë§Œë“œëŠ” ë©”ì†Œë“œ: ì¸ìë¡œ (í•  ì¼ id(DBìš©), í•  ì¼ ë‚´ìš©, ì™„ë£Œ ì—¬ë¶€) ë°›ì•„ì˜´
    function createTodoElement(id, todoText, state) {
      const li = document.createElement('li');
      li.className = "task-item flex items-center justify-between";
      li.innerHTML = `
      <div class="flex items-center">
        <input type="checkbox" class="custom-checkbox" data-id="${id}" ${state ? 'checked' : ''}>
        <span class="ml-2 text-base${state ? ' line-through text-gray-500' : ''}" id="todolist-context">${todoText}</span>
      </div>
      <div class="task-actions flex">
        <button class="w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 edit-btn" data-id="${id}">
          <i class="ri-edit-line"></i>
        </button>
        <button class="w-6 h-6 flex items-center justify-center text-gray-400 hover:text-red-500 delete-btn" data-id="${id}">
          <i class="ri-delete-bin-line"></i>
        </button>
      </div>`;

      //ìƒˆë¡œ ë§Œë“œëŠ” í•  ì¼ ìš”ì†Œë§ˆë‹¤ "ì²´í¬ë°•ìŠ¤ | í•  ì¼ ë‚´ìš©(context) ë¶€ë¶„ | ì‚­ì œ | ìˆ˜ì • ë²„íŠ¼" ìƒì„± ë° ì—°ê²°
      const taskText = li.querySelector('#todolist-context');
      const checkbox = li.querySelector('.custom-checkbox');
      const editBtn = li.querySelector('.edit-btn');
      const deleteBtn = li.querySelector('.delete-btn');

      //ì²´í¬ë°•ìŠ¤ ê´€ë ¨ ì´ë²¤íŠ¸
      checkbox.addEventListener('change', function () {
        //ì²´í¬ëœ ê²½ìš° í•´ë‹¹ id ê°€ì ¸ì™€ì„œ ìƒíƒœ ìˆ˜ì •
        const id = this.dataset.id;
        const checked = this.checked;
        if (checked) {
          taskText.classList.add('line-through', 'text-gray-500');
        } else {
          taskText.classList.remove('line-through', 'text-gray-500');
        }
        //ë°±ì—”ë“œì— ìƒíƒœ ë³€ê²½ ì „ë‹¬
        fetch('/checkbox', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ id: id, state: checked })
        });
      });

      //í¸ì§‘(ì—°í•„ëª¨ì–‘) ë²ˆíŠ¸ í´ë¦­ ì´ë²¤íŠ¸
      editBtn.addEventListener('click', function () {
        //ìˆ˜ì •í•  ìˆ˜ ìˆë„ë¡ attribute ì§€ì •
        taskText.setAttribute('contenteditable', 'true');
        taskText.focus();
        //ì—”í„° ì…ë ¥ìœ¼ë¡œ ì™„ì„±í•˜ë„ë¡ í•˜ëŠ” ë¶€ë¶„
        taskText.addEventListener('keydown', (e) => {
          if (e.key == 'Enter') {
            e.preventDefault();
            taskText.blur();
          }
        });
        taskText.addEventListener('blur', () => {
          taskText.setAttribute('contenteditable', 'false');
          const updatedText = taskText.textContent.trim();
          //ìˆ˜ì •í•œ ë‚´ìš© ë°±ì—”ë“œë¡œ ì „ë‹¬ ì¸ì:(id, ìˆ˜ì •í•œ context ë‚´ìš©)
          fetch('/edit', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ id: id, todo: updatedText })
          });
        }, { once: true });
      });

      //ì‚­ì œ(ì“°ë ˆê¸°í†µ)ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
      deleteBtn.addEventListener('click', function () {
        //ì‚­ì œ ì „ í•  ì¼ì˜ id ì „ë‹¬í•˜ì—¬ í•´ë‹¹ id DBì—ì„œ ì‚­ì œ
        fetch('/delete', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ id: id })
        }).then(() => li.remove()); //ì´í›„ì— ì„±ê³µ ë°˜í™˜ë˜ë©´ html ìš”ì†Œ ì‚­ì œ
      });

      return li;
    }

    //í•  ì¼ ì¶”ê°€ ë©”ì†Œë“œ (+ ì¶”ê°€í•˜ê¸° ë²„íŠ¼ í´ë¦­ ì´ë²¤íˆ¬)
    document.getElementById('addtodo').addEventListener('click', function () {
      const todoText = "ìƒˆë¡œìš´ í•  ì¼";
      const state = false; //ê¸°ë³¸ ìƒíƒœ unchecked

      //ì¶”ê°€í•œ ë‚´ìš© ë°±ì—”ë“œë¡œ ì „ë‹¬: ì„ íƒëœ ì›”, ì¼(ë‹¬ë ¥ì˜ ë‚ ì§œ í´ë¦­ ì‹œ ë³€ê²½ë˜ëŠ” ë³€ìˆ˜ ì¸ìë¡œ) + ì¶”ê°€í•œ í•  ì¼ í…ìŠ¤íŠ¸ ë‚´ìš©
      // + idëŠ” ë°ì´í„°ë² ì´ìŠ¤ ìª½ì—ì„œ ìƒì„±ë  ë•Œë§ˆë‹¤ ìƒˆë¡­ê²Œ ìƒì„±ë˜ë„ë¡í•¨
      fetch('/add', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          todo: todoText,
          month: selectedMonth,
          day: selectedDay
        })
      }) //ìƒì„± ì„±ê³µ ì‹œ ìš”ì†Œ ì¶”ê°€
        .then(res => res.json())
        .then(data => {
          if (data.success) {
            const li = createTodoElement(data.id, todoText, state); //í•  ì¼ ëª©ë¡ ìš”ì†Œ ì¶”ê°€
            const todoArea = document.getElementById("todoarea");
            const ul = todoArea.querySelector('ul') || document.createElement('ul');
            ul.className = "space-y-2";
            ul.appendChild(li); //ì•„ë˜ì— ë¶™ì´ê¸°
            if (!todoArea.querySelector('ul')) {
              const wrapDiv = document.createElement('div');
              wrapDiv.className = "mb-2";
              wrapDiv.appendChild(ul);
              todoArea.appendChild(wrapDiv);
            }
          } else {
            alert('í•  ì¼ ì¶”ê°€ ì‹¤íŒ¨');
          }
        });
    });

    
  </script>

</body>

</html>
